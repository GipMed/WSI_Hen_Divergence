this is a complete package for preprocessing an incoming dataset